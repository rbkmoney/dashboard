<div fxLayout="column" fxLayoutGap="20px">
    <dsh-search-form (formValueChanges)="search($event)"></dsh-search-form>

    <dsh-card>
        <dsh-card-content fxLayout="column" fxLayoutGap="15px">
            <dsh-last-updated (update)="refresh()" [lastUpdated]="lastUpdated"></dsh-last-updated>
            <div class="table-container">
                <table dshTable [dataSource]="dataSource">
                    <ng-container dshColumnDef="amount">
                        <th dshHeaderCell fxFlex="150px" *dshHeaderCellDef>
                            {{ localeBaseDir + '.table.amount' | lc }}
                        </th>
                        <td dshCell fxFlex="150px" *dshCellDef="let invoice">
                            {{ invoice.amount | fromMinor | currency: invoice.currency }}
                        </td>
                    </ng-container>

                    <ng-container dshColumnDef="status">
                        <th dshHeaderCell fxFlex="140px" *dshHeaderCellDef>
                            {{ localeBaseDir + '.table.status' | lc }}
                        </th>
                        <td dshCell fxFlex="140px" *dshCellDef="let invoice">
                            <dsh-status [color]="invoice.status | invoiceStatusColor">{{
                                'common.invoiceStatus.' + invoice.status | lc
                            }}</dsh-status>
                        </td>
                    </ng-container>

                    <ng-container dshColumnDef="createdAt">
                        <th dshHeaderCell *dshHeaderCellDef>
                            {{ localeBaseDir + '.table.createdAt' | lc }}
                        </th>
                        <td dshCell *dshCellDef="let invoice">
                            {{ invoice.createdAt | date: 'dd MMMM yyyy, HH:mm' }}
                        </td>
                    </ng-container>

                    <ng-container dshColumnDef="invoiceID">
                        <th dshHeaderCell *dshHeaderCellDef fxHide fxShow.gt-sm>
                            {{ localeBaseDir + '.table.invoiceID' | lc }}
                        </th>
                        <td dshCell *dshCellDef="let invoice" fxHide fxShow.gt-sm>
                            <a class="link-with-arrow" fxFlex fxLayoutAlign="start center"
                                ><span>{{ invoice.invoiceID }}</span>
                                <mat-icon class="arrow-forward">arrow_forward</mat-icon></a
                            >
                        </td>
                    </ng-container>

                    <ng-container dshColumnDef="paymentID">
                        <th dshHeaderCell *dshHeaderCellDef fxHide fxShow.gt-sm>
                            {{ localeBaseDir + '.table.paymentID' | lc }}
                        </th>
                        <td dshCell *dshCellDef="let invoice" fxHide fxShow.gt-sm>
                            <a class="link-with-arrow" fxFlex fxLayoutAlign="start center"
                                ><span>{{ invoice.paymentID }}</span>
                                <mat-icon class="arrow-forward">arrow_forward</mat-icon></a
                            >
                        </td>
                    </ng-container>

                    <ng-container dshColumnDef="reason">
                        <th dshHeaderCell *dshHeaderCellDef>{{ localeBaseDir + '.table.reason' | lc }}</th>
                        <td dshCell *dshCellDef="let invoice">
                            <span class="truncate">{{ invoice.reason }}</span>
                        </td>
                    </ng-container>

                    <ng-container dshColumnDef="actions">
                        <th dshHeaderCell fxFlex="42px" *dshHeaderCellDef></th>
                        <td dshCell fxFlex="42px" *dshCellDef="let invoice">
                            <button dsh-icon-button><mat-icon>more_vert</mat-icon></button>
                        </td>
                    </ng-container>

                    <tr dsh-header-row *dshHeaderRowDef="displayedColumns"></tr>
                    <tr dsh-row *dshRowDef="let row; columns: displayedColumns"></tr>
                </table>
            </div>

            <button *ngIf="lastContinuationToken" (click)="showMore()" dsh-button>{{ 'common.showMore' | lc }}</button>
        </dsh-card-content>
    </dsh-card>
</div>
