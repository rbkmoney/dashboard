<div *transloco="let t; scope: 'claim'; read: 'claim.conversation'" fxLayout="column" fxLayoutGap="20px">
    <dsh-timeline>
        <dsh-timeline-item>
            <dsh-timeline-item-title>
                <span>{{ t.timeline.claimCreated }}&nbsp;</span>
                <span *transloco="let root"
                    >{{ claimCreatedAt$ | async | humanizedDuration: { largest: 1 } }} {{ root.ago }}</span
                >
            </dsh-timeline-item-title>
            <dsh-timeline-item-badge>
                <mat-icon svgIcon="create"></mat-icon>
            </dsh-timeline-item-badge>
        </dsh-timeline-item>
        <dsh-timeline-item *ngFor="let item of timelineInfo$ | async; trackBy: simpleTrackBy">
            <dsh-timeline-item-title>
                <div fxFlex fxLayout="row" fxLayoutAlign="space-between end">
                    <div>
                        <span class="mat-body-2">{{ t.timeline.userInfo[item.userInfo.userType] }}</span>
                        {{ t.timeline.action[item.action] }}
                        <span *transloco="let root"
                            >{{ item.createdAt | humanizedDuration: { largest: 1 } }} {{ root.ago }}</span
                        >
                    </div>
                    <mat-icon
                        *ngIf="item.action === 'changesAdded'"
                        class="title-action-icon"
                        svgIcon="more_horiz"
                        [matMenuTriggerFor]="menu"
                    ></mat-icon>
                </div>
                <mat-menu #menu="matMenu" xPosition="before">
                    <button mat-menu-item (click)="editDocument(item)">{{ t.action.edit }}</button>
                    <button mat-menu-item (click)="expandAll = !expandAll">{{ t.action.toggleDetails }}</button>
                </mat-menu>
            </dsh-timeline-item-title>
            <dsh-timeline-item-badge [color]="item.action | actionColor">
                <mat-icon [svgIcon]="item.action | actionIcon"></mat-icon>
            </dsh-timeline-item-badge>
            <dsh-timeline-item-content *ngIf="item.modifications.length !== 0">
                <div fxLayout="column" fxLayoutGap="10px">
                    <div *ngFor="let modification of item.modifications; trackBy: simpleTrackBy">
                        <dsh-document-container
                            *ngIf="isDocumentModificationUnit(modification)"
                            [expandAll]="expandAll"
                            [unit]="modification.claimModificationType"
                        ></dsh-document-container>
                        <dsh-comment-container
                            *ngIf="isCommentModificationUnit(modification)"
                            [unit]="modification.claimModificationType"
                        ></dsh-comment-container>
                        <dsh-file-container
                            *ngIf="isFileModificationUnit(modification)"
                            [unit]="modification.claimModificationType"
                            deletion
                            (delete)="deleteFile(modification)"
                        ></dsh-file-container>
                    </div>
                </div>
            </dsh-timeline-item-content>
        </dsh-timeline-item>
    </dsh-timeline>
    <dsh-send-comment (conversationSaved)="commentSaved($event)"></dsh-send-comment>
</div>
