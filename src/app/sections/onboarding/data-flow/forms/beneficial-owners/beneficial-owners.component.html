<form
    [formGroup]="form$ | async"
    fxLayout="column"
    *transloco="let t; scope: 'onboarding'; read: 'onboarding.dataFlow.beneficialOwners'"
>
    <section class="checkbox-section">
        <mat-checkbox [checked]="isNoOwners$ | async" (change)="noOwnersChange($event)">{{ t.noOwners }}</mat-checkbox>
    </section>
    <div *ngIf="!(isNoOwners$ | async)" formArrayName="beneficialOwners">
        <div
            class="beneficial-owner-container"
            *ngFor="let beneficialOwner of (beneficialOwners$ | async).controls; let i = index"
            [formGroupName]="i"
        >
            <div class="owner-count">{{ t.owner }} #{{ i + 1 }}</div>
            <div fxLayout>
                <mat-form-field fxFlex="48.5%">
                    <mat-label>{{ t.ownershipPercentage }}</mat-label>
                    <input matInput type="number" formControlName="ownershipPercentage" required />
                </mat-form-field>
            </div>
            <dsh-private-entity-info [form]="beneficialOwner.get('privateEntityInfo')"></dsh-private-entity-info>
            <dsh-russian-domestic-passport
                [form]="beneficialOwner.get('russianDomesticPassport')"
            ></dsh-russian-domestic-passport>
            <dsh-pdl-info [form]="beneficialOwner.get('pdlInfo')"></dsh-pdl-info>
            <section class="checkbox-section" fxLayout="column" [fxLayoutGap]="layoutGap">
                <mat-checkbox formControlName="usaTaxResident">{{ t.usaTaxResident }}</mat-checkbox>
                <mat-checkbox formControlName="exceptUsaTaxResident">{{ t.exceptUsaTaxResident }}</mat-checkbox>
            </section>
            <div class="beneficial-owner-actions" *ngIf="i !== 0" fxLayout="row" fxLayoutAlign="end">
                <button dsh-stroked-button color="warn" (click)="removeOwner(i)">
                    {{ t.removeOwner }}
                </button>
            </div>
            <mat-divider></mat-divider>
        </div>
        <div class="beneficial-owner-actions" fxLayout="row" fxLayoutAlign="end">
            <button dsh-stroked-button color="accent" (click)="addOwner()">
                {{ t.addOwner }}
            </button>
        </div>
    </div>
</form>
